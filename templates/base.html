{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="TeleMed - Telemedicine Access for Rural Healthcare. Connect with doctors, book appointments, and access quality healthcare from anywhere.">
    <meta name="keywords" content="telemedicine, rural healthcare, online doctor, video consultation, mobile clinic">
    <title>{% block title %}TeleMed - Rural Healthcare{% endblock %}</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Outfit:wght@400;500;600;700;800&display=swap"
        rel="stylesheet">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- Styles -->
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">

    {% block extra_css %}{% endblock %}
</head>

<body>
    <!-- Navigation -->
    <nav class="navbar" id="navbar">
        <div class="navbar-container">
            <a href="{% url 'home' %}" class="navbar-brand">
                <i class="fas fa-heartbeat"></i>
                <span>TeleMed</span>
            </a>

            <ul class="navbar-menu" id="navbar-menu">
                <li><a href="{% url 'home' %}"
                        class="navbar-link {% if request.resolver_match.url_name == 'home' %}active{% endif %}">Home</a>
                </li>
                <!-- Services Dropdown -->
                <li class="nav-dropdown">
                    <a href="{% url 'services' %}"
                        class="navbar-link {% if request.resolver_match.url_name == 'services' or request.resolver_match.url_name == 'mobile_clinics' %}active{% endif %}">
                        Services <i class="fas fa-chevron-down" style="font-size: 0.6rem; margin-left: 4px;"></i>
                    </a>
                    <div class="nav-dropdown-menu">
                        <a href="{% url 'services' %}" class="nav-dropdown-item">
                            <i class="fas fa-stethoscope"></i> All Services
                        </a>
                        <a href="{% url 'mobile_clinics' %}" class="nav-dropdown-item">
                            <i class="fas fa-truck-medical"></i> Mobile Clinics
                        </a>
                    </div>
                </li>
                <!-- Hospitals Dropdown -->
                <li class="nav-dropdown">
                    <a href="{% url 'find_hospitals' %}"
                        class="navbar-link {% if request.resolver_match.url_name == 'find_hospitals' or request.resolver_match.url_name == 'bed_availability' %}active{% endif %}">
                        Hospitals <i class="fas fa-chevron-down" style="font-size: 0.6rem; margin-left: 4px;"></i>
                    </a>
                    <div class="nav-dropdown-menu">
                        <a href="{% url 'find_hospitals' %}" class="nav-dropdown-item">
                            <i class="fas fa-hospital"></i> Find Hospitals
                        </a>
                        <a href="{% url 'bed_availability' %}" class="nav-dropdown-item">
                            <i class="fas fa-bed"></i> Bed Availability
                        </a>
                    </div>
                </li>
                <li><a href="{% url 'about' %}"
                        class="navbar-link {% if request.resolver_match.url_name == 'about' %}active{% endif %}">About</a>
                </li>
                <li><a href="{% url 'contact' %}"
                        class="navbar-link {% if request.resolver_match.url_name == 'contact' %}active{% endif %}">Contact</a>
                </li>
            </ul>

            <div class="navbar-actions">
                {% if user.is_authenticated %}
                <!-- Logged in user dropdown -->
                <div class="dropdown">
                    <button class="btn btn-secondary btn-sm dropdown-toggle" onclick="toggleDropdown(this)">
                        <i class="fas fa-user-circle"></i> {{ user.username }}
                        <i class="fas fa-chevron-down" style="font-size: 0.7rem; margin-left: 0.25rem;"></i>
                    </button>
                    <div class="dropdown-menu">
                        <a href="{% url 'dashboard' %}" class="dropdown-item">
                            <i class="fas fa-home"></i> Dashboard
                        </a>
                        {% if user.is_superuser %}
                        <a href="/admin/" class="dropdown-item">
                            <i class="fas fa-cog"></i> Admin Panel
                        </a>
                        {% endif %}
                        <div class="dropdown-divider"></div>
                        <a href="{% url 'logout' %}" class="dropdown-item" style="color: var(--error);">
                            <i class="fas fa-sign-out-alt"></i> Logout
                        </a>
                    </div>
                </div>
                {% else %}
                <!-- Not logged in - single dropdown -->
                <div class="dropdown">
                    <button class="btn btn-primary btn-sm dropdown-toggle" onclick="toggleDropdown(this)">
                        <i class="fas fa-user"></i> Account
                        <i class="fas fa-chevron-down" style="font-size: 0.7rem; margin-left: 0.25rem;"></i>
                    </button>
                    <div class="dropdown-menu">
                        <a href="{% url 'login' %}" class="dropdown-item">
                            <i class="fas fa-sign-in-alt"></i> Login
                        </a>
                        <a href="{% url 'register' %}" class="dropdown-item">
                            <i class="fas fa-user-plus"></i> Register
                        </a>
                        <div class="dropdown-divider"></div>
                        <a href="/admin/" class="dropdown-item" style="color: var(--neutral-500);">
                            <i class="fas fa-lock"></i> Admin Login
                        </a>
                    </div>
                </div>
                {% endif %}
            </div>

            <button class="navbar-toggle" id="navbar-toggle" aria-label="Toggle menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </nav>

    <!-- Messages -->
    {% if messages %}
    <div class="container" style="padding-top: 90px;">
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }} animate-fade-in">
            <i
                class="fas fa-{% if message.tags == 'success' %}check-circle{% elif message.tags == 'error' %}exclamation-circle{% elif message.tags == 'warning' %}exclamation-triangle{% else %}info-circle{% endif %}"></i>
            <span>{{ message }}</span>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <!-- Main Content -->
    <main>
        {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    {% block footer %}
    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div>
                    <div class="footer-brand">
                        <i class="fas fa-heartbeat"></i>
                        TeleMed
                    </div>
                    <p class="footer-description">
                        Bringing quality healthcare to rural communities through telemedicine.
                        Connect with doctors, book appointments, and access medical care from anywhere.
                    </p>
                    <div class="footer-social">
                        <a href="https://facebook.com" target="_blank" title="Facebook"><i
                                class="fab fa-facebook-f"></i></a>
                        <a href="https://twitter.com" target="_blank" title="Twitter"><i class="fab fa-twitter"></i></a>
                        <a href="https://instagram.com" target="_blank" title="Instagram"><i
                                class="fab fa-instagram"></i></a>
                        <a href="https://linkedin.com" target="_blank" title="LinkedIn"><i
                                class="fab fa-linkedin-in"></i></a>
                    </div>
                </div>

                <div>
                    <h5 class="footer-title">Services</h5>
                    <ul class="footer-links">
                        <li><a href="{% url 'services' %}">Video Consultation</a></li>
                        <li><a href="{% url 'services' %}">Chat with Doctor</a></li>
                        <li><a href="{% url 'mobile_clinics' %}">Mobile Clinics</a></li>
                        <li><a href="{% url 'find_hospitals' %}">Find Hospitals</a></li>
                    </ul>
                </div>

                <div>
                    <h5 class="footer-title">Quick Links</h5>
                    <ul class="footer-links">
                        <li><a href="{% url 'about' %}">About Us</a></li>
                        <li><a href="{% url 'contact' %}">Contact</a></li>
                        <li><a href="#">Privacy Policy</a></li>
                        <li><a href="#">Terms of Service</a></li>
                    </ul>
                </div>

                <div>
                    <h5 class="footer-title">Contact</h5>
                    <ul class="footer-links">
                        <li><i class="fas fa-phone"></i> +91 99206 30080 </li>
                        <li><i class="fas fa-envelope"></i> nandita123@gmail.com</li>
                        <li><i class="fas fa-map-marker-alt"></i> Healthcare Innovation Center</li>
                    </ul>
                </div>
            </div>

            <div class="footer-bottom">
                <p class="footer-copyright">Nandita Thevar ❤️ </p>
                <div>
                    <a href="#" class="text-muted">Privacy</a>
                    &nbsp;|&nbsp;
                    <a href="#" class="text-muted">Terms</a>
                </div>
            </div>
        </div>
    </footer>
    {% endblock %}

    <!-- Chatbot -->
    <div class="chatbot-container" id="chatbot">
        <button class="chatbot-toggle" id="chatbot-toggle" aria-label="Open chatbot">
            <i class="fas fa-robot"></i>
        </button>

        <div class="chatbot-window" id="chatbot-window">
            <div class="chatbot-header">
                <div class="chatbot-title">
                    <i class="fas fa-robot"></i>
                    <span>C_Bot - Health Assistant</span>
                </div>
                <button class="chatbot-close" id="chatbot-close">&times;</button>
            </div>

            <div class="chatbot-messages" id="chatbot-messages">
                <div class="chat-message bot">
                    Hello! I'm C_Bot, your healthcare assistant. How can I help you today?
                    You can ask me about appointments, symptoms, finding hospitals, or mobile clinics.
                </div>
            </div>

            <div class="chatbot-input-container">
                <input type="text" class="chatbot-input" id="chatbot-input" placeholder="Type your message...">
                <button class="chatbot-send" id="chatbot-send">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="{% static 'js/main.js' %}"></script>
    <script src="{% static 'js/chatbot.js' %}"></script>

    <!-- Dropdown Toggle -->
    <script>
        function toggleDropdown(btn) {
            const dropdown = btn.closest('.dropdown');
            dropdown.classList.toggle('active');
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', function (e) {
            if (!e.target.closest('.dropdown')) {
                document.querySelectorAll('.dropdown.active').forEach(d => d.classList.remove('active'));
            }
        });
    </script>

    {% block extra_js %}{% endblock %}
</body>

</html>